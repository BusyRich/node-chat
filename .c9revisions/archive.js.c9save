{"ts":1350175063193,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"module.exports = {\n  fs : require('fs'),\n  _file : __dirname + '/archive.json',\n  limit : 100,\n  \n  get : function(callback) {\n    var chat = this;\n\n    this.fs.exists(this._file, function (exists) {\n      if(exists) {\n        chat.fs.readFile(chat._file, 'utf8', function(error, data) {\n          if(error === null) {\n            callback(null, JSON.parse(data));\n          } else {\n            callback(error, null);\n          }\n        });\n      } else {\n        callback(null, []);\n      }\n    });\n    \n  },\n\n  add : function(data, callback) {\n    var chat = this;\n\n    this.get(function(error, archive) {\n      if(error !== null) {\n        callback(error);\n        return;\n      }\n\n      if(archive.length >= chat.limit) {\n        archive.splice(0, 1);\n      }\n\n      archive.push(data);\n\n      chat.fs.writeFile(chat._file, JSON.stringify(archive), function(err) {\n        callback(err);\n      });\n    });\n  }\n};"]],"start1":0,"start2":0,"length1":0,"length2":918}]],"length":918}
{"contributors":[],"silentsave":false,"ts":1350175245329,"patch":[[{"diffs":[[0,"    "],[-1,"var chat = this;\n\n    this.fs.exists(this._file, function (exists) {\n      if(exists) {\n        chat"],[1,"this"],[0,".fs."]],"start1":127,"start2":127,"length1":108,"length2":12},{"diffs":[[0,"fs.readFile("],[-1,"chat"],[1,"this"],[0,"._file, 'utf"]],"start1":136,"start2":136,"length1":28,"length2":28},{"diffs":[[0,"{\n      "],[-1,"    "],[0,"if(error"]],"start1":190,"start2":190,"length1":20,"length2":16},{"diffs":[[0,"null) {\n        "],[-1," "],[-1,"   "],[0,"callback(null, J"]],"start1":211,"start2":211,"length1":36,"length2":32},{"diffs":[[0,";\n      "],[-1,"   "],[-1," "],[0,"} else {"]],"start1":259,"start2":259,"length1":20,"length2":16},{"diffs":[[0,"   } else {\n"],[-1,"    "],[0,"        call"]],"start1":264,"start2":264,"length1":28,"length2":24},{"diffs":[[0,"    "],[-1," "],[-1,"   }\n   "],[1,"}\n"],[0,"    "],[-1," "],[0,"});\n"],[-1,"      } else {\n        callback(null, []);\n      }\n    });\n    \n"],[0,"  },"]],"start1":309,"start2":309,"length1":90,"length2":18}]],"length":734,"saved":false}
